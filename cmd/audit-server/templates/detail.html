<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Audit Event {{ .Event.ID }}</title>
    <link rel="stylesheet" href="/static/style.css" />
  </head>
  <body>
    <header>
      <span class="brand">Audit Server</span>
      <span class="muted">/ Event Detail</span>
      <span style="float: right">
        <a href="/events">Back</a>
      </span>
    </header>
    <main>
      <div class="panel">
        <div class="row">
          <div><strong>ID</strong>: {{ .Event.ID }}</div>
          <div class="muted"><strong>Received</strong>: {{ .Event.CreatedAt }}</div>
        </div>
        <div class="row" style="margin-top: 8px">
          <div><strong>Method</strong>: {{ .Event.Method }}</div>
          <div><strong>Path</strong>: <code>{{ .Event.Path }}</code></div>
          <div><strong>Status</strong>: {{ .Event.StatusCode }}</div>
          <div><strong>Duration</strong>: {{ .Event.DurationMs }}ms</div>
        </div>
        <div class="row" style="margin-top: 8px">
          <div><strong>User</strong>: {{ .Event.Username }} ({{ .Event.UserID }})</div>
          <div><strong>Token</strong>: {{ .Event.TokenName }} ({{ .Event.TokenID }})</div>
          <div><strong>Group</strong>: {{ .Event.UsingGroup }}</div>
        </div>
        <div class="row" style="margin-top: 8px">
          <div><strong>Channel</strong>: {{ .Event.ChannelName }} ({{ .Event.ChannelID }})</div>
          <div><strong>Type</strong>: {{ .Event.ChannelType }}</div>
          <div><strong>Model</strong>: {{ .Event.Model }}</div>
        </div>
        <div class="row" style="margin-top: 8px">
          <div><strong>Remote IP</strong>: {{ .Event.RemoteIP }}</div>
          <div><strong>UA</strong>: <span class="muted">{{ .Event.UserAgent }}</span></div>
        </div>
        <div class="row" style="margin-top: 8px">
          <div><strong>Webhook TS</strong>: {{ .Event.AuditTimestamp }}</div>
          <div><strong>Signature</strong>: <code>{{ .Event.Signature }}</code></div>
        </div>
      </div>

      <div class="panel">
        <h3 style="margin-top: 0">Request Body Preview</h3>
        <div class="muted">
          encoding={{ .Event.RequestBodyEncoding }}, bytes={{ .Event.RequestBodyBytes }}, truncated={{ .Event.RequestBodyTruncated }}
        </div>
        <pre>{{ .Event.RequestBody }}</pre>
      </div>

      <div class="panel">
        <h3 style="margin-top: 0">Raw JSON Payload</h3>
        <pre>{{ .Event.RawPayload }}</pre>
      </div>
    </main>
  </body>
</html>

